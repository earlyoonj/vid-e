{% extends 'base.html' %}

{% block css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">
{% endblock %}

{% block title %}
    <h1>영상을 업로드하세요</h1>
    <p>mp4 확장자를 지원합니다</p>
{% endblock %}


{% block content %}
    <!-- 파일 리스트 -->
    <div class="content-container">
        <div id = "page-title">
        VidE
        </div>
        <div id = "page-sub">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi 
        </div>
        <div id = "upload">
            <form id="input-form" action="{{ url_for('upload') }}" method="POST" enctype="multipart/form-data">
                <label id="upload-label" for="input-file">
                    <input type="file" id="input-file" class="file" name="video" onchange="this.form.submit();" accept="video/mp4"/>
                    <span id = "upload-loader">Upload</span>
                </label>    
            </form>
        </div>
        <div id = "archive-content-list">
            <div id = "menu-archive">Archive</div>
            <ul>
            {% for i in range(video|length):  %}
            {% if 3 > i %}
                {% include 'status/archive_item.html' %}
            {% endif %}
            {% endfor %}
            </ul>
            
            <a class="archBtn" href="{{ url_for('archive') }}" >
                VIEW MORE →
            </a>
        </div>
    </div>

    
    
{% endblock %}


{% block js %}
<!-- static js -->
<script src="{{ url_for('static', filename='js/archive.js') }}" type="text/javascript"></script>

<script type="text/javascript">
    var data = {{ video | tojson }};
    var updateVids = {{ output | tojson }};

    var vid_list = [];

    function update(updateVids){
        for (var n=0; n<data.length; n++){
            var i = data[n].id;
            updateStatus(i, '.process.rm-silence', updateVids[n].rm_silence.status);
            updateStatus(i, '.process.add-effect', updateVids[n].add_effect.status);

            console.log("---updated---");    
        };
    };

    const uploadBtn = document.getElementById('upload');

    uploadBtn.addEventListener('click', (e) =>{
        const loader = document.getElementById("upload-loader");
        const navLoader = document.getElementById("input-label");

        loader.classList.add("processing");
        navLoader.classList.add("processing");
    })

    update(updateVids);
    
</script>
{% endblock %}