{% extends 'layout.html' %}


{% block css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/add_effect.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css">
{% endblock %}


<!-- header : video -->
{% block video %}
    <video id="input-video" src="{{ url_for('static', filename=video.path) }}" width = "280" height = "160" controls></video>
{% endblock %}
<!-- header : control -->
{% block control %}
{% endblock %}


{% block content %}

    <ol id="transcript-list">
        {% for sentence in keyword_sentences %}
            <li>
                <audio src=""></audio>
                <p>
                    {{sentence.text.prev}}
                    <strong class="keyword">{{sentence.text.keyword}}</strong>
                    {{sentence.text.next}}
                </p>
            </li>
        {% endfor %}
    </ol>

    <!-- 여기 -->
    <div id="effect-list">
        <p>효과음 라이브러리</p>
        <p>long effect</p>
        <div class="long">
        
            <h4>휙</h4>
            {% for file in long_effect[0][:] %}
                <audio id = "long{i}">
                    <source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">
                </audio>
                <button onclick="playAudio()" type="button" style="cursor: pointer;">PLAY</button>
                <script type="text/javascript">
                    var x = document.getElementById("long{i}");
                    function playAudio() {
                        x.play();
                    }
                </script>
            {% endfor %}


            <h4>띵</h4>
            {% for file in long_effect[1][:] %}
            <audio controls>
                <source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">
            </audio>
            {% endfor %}

            <h4>뿅</h4>
            {% for file in long_effect[2][:] %}
            <audio controls>
                <source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">
            </audio>
            {% endfor %}

            <h4>별가루</h4>
            {% for file in long_effect[3][:] %}
            <audio controls>
                <source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">
            </audio>
            {% endfor %}
        </div>

        <p>short effect</p>
        <div class="short">
            <h4>휙</h4>
            {% for file in long_effect[0][:] %}
            <audio controls>
                <source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">
            </audio>
            {% endfor %}

            <h4>띵</h4>
            {% for file in long_effect[1][:] %}
            <audio controls>
                <source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">
            </audio>
            {% endfor %}

            <h4>뿅</h4>
            {% for file in long_effect[2][:] %}
            <audio controls>
                <source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">
            </audio>
            {% endfor %}

            <h4>별가루</h4>
            {% for file in long_effect[3][:] %}
            <audio controls>
                <source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">
            </audio>
            {% endfor %}
        </div>
    </div>

    <!-- <div id="add-effect-control">
        <ol id="transcript-list">
            {% for sentence in keyword_sentences %}
                <li>
                    <audio src=""></audio>
                    <p>
                        {{sentence.text.prev}}
                        <strong class="keyword">{{sentence.text.keyword}}</strong>
                        {{sentence.text.next}}
                    </p>
                </li>
            {% endfor %}
        </ol>
        <div id="effect-list"></div>
    </div> -->

{% endblock %} 

{% block js %}
     <script>
        //클릭한 리스트의 문장시작, 키워드시작, 키워드끝나는 시간 받아오기
        const sentences = JSON.parse('{{keyword_sentences | tojson}}');
        var li = document.querySelectorAll('li');
        function li_click(idx){
        li[idx].onclick = function(){
        senten_start = sentences[idx]['time']['sentence']['start'];
        keyword_start = sentences[idx]['time']['keyword']['start'];
        keyword_end = sentences[idx]['time']['keyword']['end'];
        to_add_start = keyword_start - senten_start;
        to_add_end = keyword_end - senten_start;

        console.log(to_add_start);
        console.log(to_add_end);
           };
        }
        for(var i=0; i<li.length; i++){
        li_click(i);  
        }
    </script>
{% endblock %}