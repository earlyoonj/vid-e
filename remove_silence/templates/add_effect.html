{% extends 'layout.html' %}


{% block css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/add_effect.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css">
{% endblock %}


<!-- header : video -->
{% block video %}
    <video id="input-video" src="{{ url_for('static', filename=video.path) }}" width = "280" height = "160" controls></video>
{% endblock %}
<!-- header : control -->
{% block control %}
{% endblock %}


{% block content %}

    <ol id="transcript-list">
        {% for sentence in keyword_sentences %}
            <li>
                <audio src=""></audio>
                <p>
                    {{sentence.text.prev}}
                    <strong class="keyword">{{sentence.text.keyword}}</strong>
                    {{sentence.text.next}}
                </p>
            </li>
        {% endfor %}
    </ol>

    <!-- 여기 -->
    <div id="effect-list">
        <p>효과음 라이브러리</p>
        <p>short effect</p>
        <div class="short">

            <h4>뾱</h4>
            <div id = "short_bbyok"></div>
            <script>
                var i = 1;
            </script>
            {% for file in short_effect[0][:] %}
                <script type="text/javascript">
                    document.write('<audio id='+"short_bbyok0"+i+'>');
                    document.write('<source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">')
                    document.write('</audio>')
                    short_bbyok.innerHTML += `<button class="btn0${i}" onclick="play_short_bbyok0${i}()" style="cursor:pointer">▶ button 0${i}</button>`;
                    function play_short_bbyok01() {
                        var x = document.getElementById("short_bbyok01");
                        x.play();
                    }
                    function play_short_bbyok02() {
                        var x = document.getElementById("short_bbyok02");
                        x.play();
                    }
                    i++;
                </script>
            {% endfor %}

            <h4>띵</h4>
            <div id = "short_dding"></div>
            <script>
                var i = 1;
            </script>
            {% for file in short_effect[1][:] %}
                <script type="text/javascript">
                    document.write('<audio id='+"short_dding0"+i+'>');
                    document.write('<source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">')
                    document.write('</audio>')
                    short_dding.innerHTML += `<button class="btn0${i}" onclick="play_short_dding0${i}()" style="cursor:pointer">▶ button 0${i}</button>`;
                    function play_short_dding01() {
                        var x = document.getElementById("short_dding01");
                        x.play();
                    }
                    function play_short_dding02() {
                        var x = document.getElementById("short_dding02");
                        x.play();
                    }
                    i++;
                </script>
            {% endfor %}

            <h4>휙</h4>
            <div id = "short_swish"></div>
            <script>
                var i = 1;
            </script>
            {% for file in short_effect[2][:] %}
                <script type="text/javascript">
                    document.write('<audio id='+"short_swish0"+i+'>');
                    document.write('<source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">')
                    document.write('</audio>')
                    short_swish.innerHTML += `<button class="btn0${i}" onclick="play_short_swish0${i}()" style="cursor:pointer">▶ button 0${i}</button>`;
                    function play_short_swish01() {
                        var x = document.getElementById("short_swish01");
                        x.play();
                    }
                    function play_short_swish02() {
                        var x = document.getElementById("short_swish02");
                        x.play();
                    }
                    i++;
                </script>
            {% endfor %}

            <h4>별가루</h4>
            <div id = "short_star"></div>
            <script>
                var i = 1;
            </script>
            {% for file in short_effect[3][:] %}
                <script type="text/javascript">
                    document.write('<audio id='+"short_star0"+i+'>');
                    document.write('<source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">')
                    document.write('</audio>')
                    short_star.innerHTML += `<button class="btn0${i}" onclick="play_short_star0${i}()" style="cursor:pointer">▶ button 0${i}</button>`;
                    function play_short_star01() {
                        var x = document.getElementById("short_star01");
                        x.play();
                    }
                    function play_short_star02() {
                        var x = document.getElementById("short_star02");
                        x.play();
                    }
                    i++;
                </script>
            {% endfor %}
        </div>

        <p>long effect</p>
        <div class="long">

            <h4>뾰롱</h4>
            <div id = "long_bbyorong"></div>
            <script>
                var i = 1;
            </script>
            {% for file in long_effect[0][:] %}
                <script type="text/javascript">
                    document.write('<audio id='+"long_bbyorong0"+i+'>');
                    document.write('<source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">')
                    document.write('</audio>')
                    long_bbyorong.innerHTML += `<button class="btn0${i}" onclick="play_long_bbyorong0${i}()" style="cursor:pointer">▶ button 0${i}</button>`;
                    function play_long_bbyorong01() {
                        var x = document.getElementById("long_bbyorong01");
                        x.play();
                    }
                    function play_long_bbyorong02() {
                        var x = document.getElementById("long_bbyorong02");
                        x.play();
                    }
                    i++;
                </script>
            {% endfor %}

            <h4>띠링</h4>
            <div id = "long_ddiring"></div>
            <script>
                var i = 1;
            </script>
            {% for file in long_effect[1][:] %}
                <script type="text/javascript">
                    document.write('<audio id='+"long_ddiring0"+i+'>');
                    document.write('<source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">')
                    document.write('</audio>')
                    long_ddiring.innerHTML += `<button class="btn0${i}" onclick="play_long_ddiring0${i}()" style="cursor:pointer">▶ button 0${i}</button>`;
                    function play_long_ddiring01() {
                        var x = document.getElementById("long_ddiring01");
                        x.play();
                    }
                    function play_long_ddiring02() {
                        var x = document.getElementById("long_ddiring02");
                        x.play();
                    }
                    i++;
                </script>
            {% endfor %}

            <h4>휘익</h4>
            <div id = "long_swish"></div>
            <script>
                var i = 1;
            </script>
            {% for file in long_effect[2][:] %}
                <script type="text/javascript">
                    document.write('<audio id='+"long_swish0"+i+'>');
                    document.write('<source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">')
                    document.write('</audio>')
                    long_swish.innerHTML += `<button class="btn0${i}" onclick="play_long_swish0${i}()" style="cursor:pointer">▶ button 0${i}</button>`;
                    function play_long_swish01() {
                        var x = document.getElementById("long_swish01");
                        x.play();
                    }
                    function play_long_swish02() {
                        var x = document.getElementById("long_swish02");
                        x.play();
                    }
                    i++;
                </script>
            {% endfor %}

            <h4>별가루</h4>
            <div id = "long_star"></div>
            <script>
                var i = 1;
            </script>
            {% for file in long_effect[3][:] %}
                <script type="text/javascript">
                    document.write('<audio id='+"long_star0"+i+'>');
                    document.write('<source src="{{ url_for('static', filename='sound-effect/'+file) }}" type="audio/mpeg">')
                    document.write('</audio>')
                    long_star.innerHTML += `<button class="btn0${i}" onclick="play_long_star0${i}()" style="cursor:pointer">▶ button 0${i}</button>`;
                    function play_long_star01() {
                        var x = document.getElementById("long_star01");
                        x.play();
                    }
                    function play_long_star02() {
                        var x = document.getElementById("long_star02");
                        x.play();
                    }
                    i++;
                </script>
            {% endfor %}
        </div>
    </div>

    <!-- <div id="add-effect-control">
        <ol id="transcript-list">
            {% for sentence in keyword_sentences %}
                <li>
                    <audio src=""></audio>
                    <p>
                        {{sentence.text.prev}}
                        <strong class="keyword">{{sentence.text.keyword}}</strong>
                        {{sentence.text.next}}
                    </p>
                </li>
            {% endfor %}
        </ol>
        <div id="effect-list"></div>
    </div> -->

{% endblock %} 

{% block js %}
    <script>
        //클릭한 리스트의 문장시작, 키워드시작, 키워드끝나는 시간 받아오기
        const sentences = JSON.parse('{{keyword_sentences | tojson}}');
        var li = document.querySelectorAll('li');
        function li_click(idx){
        li[idx].onclick = function(){
        senten_start = sentences[idx]['time']['sentence']['start'];
        keyword_start = sentences[idx]['time']['keyword']['start'];
        keyword_end = sentences[idx]['time']['keyword']['end'];
        to_add_start = keyword_start - senten_start;
        to_add_end = keyword_end - senten_start;

        console.log(to_add_start);
        console.log(to_add_end);
        };
        }
        for(var i=0; i<li.length; i++){
        li_click(i);  
        }
    </script>

{% endblock %}